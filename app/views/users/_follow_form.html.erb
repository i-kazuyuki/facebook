<div id="follow_form_<%= user.id %>">
  <% unless current_user.following?(user) %>
    <%= form_for(current_user.relationships.build(followed_id: user.id), remote: true) do |f| %>
      <%= f.hidden_field :followed_id %>
        <%= button_tag( class: "btn btn-sm btn-primary") do %>
          <%= content_tag :span, "友達になる", class: "fa fa-user-plus" %>
        <% end %>
      <% end %>
      <% else %>
        <%= form_for(current_user.relationships.find_by(followed_id: user.id), html: { method: :delete }, remote: true) do |f| %>
        <%= button_tag( class: "btn btn-sm") do %>
          <%= content_tag :span, "友達から削除", class: "fa fa-user-times" %>
        <% end %>
      <% end %>
    <% end %>
</div>
